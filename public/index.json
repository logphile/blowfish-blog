
[{"content":" ","date":"March 30, 2025","externalUrl":null,"permalink":"/blog/","section":"","summary":"\u003c!-- raw HTML omitted --\u003e","title":"","type":"blog"},{"content":"","date":"March 30, 2025","externalUrl":null,"permalink":"/","section":"logPhile","summary":"","title":"logPhile","type":"page"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/categories/automation/","section":"Categories","summary":"","title":"Automation","type":"categories"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/tags/automation/","section":"Tags","summary":"","title":"Automation","type":"tags"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/categories/azure-identity/","section":"Categories","summary":"","title":"Azure Identity","type":"categories"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"If it\u0026rsquo;s not in Entra, it doesn\u0026rsquo;t exist‚Äîto your policies, dynamic groups, or audit logs. Missing user metadata like department, title, or usageLocation can silently break downstream automations and cause inconsistencies that are hard to debug.\nThis post walks through how to audit Entra ID user profiles using PowerShell and Microsoft Graph, flagging any accounts with incomplete or empty property fields.\n‚öôÔ∏è Prerequisites #\rPowerShell 7+ Microsoft Graph PowerShell SDK Admin permissions to Microsoft Entra ID Install-Module Microsoft.Graph -Scope CurrentUser Connect-MgGraph -Scopes \u0026#34;User.Read.All\u0026#34;, \u0026#34;Directory.Read.All\u0026#34; Note: You only need read access for this operation, not User.Write.All.\rüîç Properties We‚Äôre Auditing #\rWe‚Äôll be checking each user for the following missing or blank fields:\ndepartment jobTitle usageLocation manager Optional: mobilePhone, officeLocation You can customize this based on your environment.\nüõ†Ô∏è PowerShell Script #\r$propertiesToCheck = @(\u0026#34;Department\u0026#34;, \u0026#34;JobTitle\u0026#34;, \u0026#34;UsageLocation\u0026#34;, \u0026#34;Manager\u0026#34;, \u0026#34;MobilePhone\u0026#34;, \u0026#34;OfficeLocation\u0026#34;) $results = @() $users = Get-MgUser -All -Property \u0026#34;Id,DisplayName,UserPrincipalName,Department,JobTitle,UsageLocation,Manager,MobilePhone,OfficeLocation\u0026#34; foreach ($user in $users) { $missingProps = @() foreach ($prop in $propertiesToCheck) { if (-not $user.$prop) { $missingProps += $prop } } if ($missingProps.Count -gt 0) { $results += [PSCustomObject]@{ DisplayName = $user.DisplayName UserPrincipalName = $user.UserPrincipalName MissingProperties = ($missingProps -join \u0026#34;, \u0026#34;) } } } $results | Format-Table -AutoSize üì§ Exporting to CSV (Optional) #\r$results | Export-Csv -Path \u0026#34;EntraUserAudit.csv\u0026#34; -NoTypeInformation üß† Why This Matters #\rBroken dynamic group rules License assignment failures Inaccurate compliance or org charts Missed automation triggers Directory drift happens quietly. This gives you visibility and control.\nüöÄ Ideas to Extend This #\rAuto-tag users with profileStatus = incomplete Send Teams alerts or email summaries Schedule via Azure Automation or GitHub Actions üìé Resources #\rMicrosoft Graph PowerShell SDK Docs User Resource Type - Microsoft Graph Graph Query Parameters Reference After several years as a stay-at-home dad, I\u0026rsquo;m working my way back into the tech field‚Äîbrushing up on tools, learning what‚Äôs changed, and sharing the journey along the way. This blog is part learning tool, part signal to employers, and part proof of work. Thanks for reading!\r","date":"March 28, 2025","externalUrl":null,"permalink":"/blog/directory-drift/","section":"","summary":"Missing user metadata can break your policies, groups, and reports. Learn how to audit Entra ID user profiles using PowerShell and Microsoft Graph.","title":"Directory Drift: Auditing Incomplete Entra User Profiles with PowerShell + Graph","type":"blog"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/tags/entra-id/","section":"Tags","summary":"","title":"Entra Id","type":"tags"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/tags/microsoft-graph/","section":"Tags","summary":"","title":"Microsoft Graph","type":"tags"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/tags/powershell/","section":"Tags","summary":"","title":"Powershell","type":"tags"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"March 28, 2025","externalUrl":null,"permalink":"/tags/user-audit/","section":"Tags","summary":"","title":"User Audit","type":"tags"},{"content":"","date":"March 18, 2025","externalUrl":null,"permalink":"/tags/azure/","section":"Tags","summary":"","title":"Azure","type":"tags"},{"content":"One-off user creation is fine‚Äîuntil you need scale, consistency, and future-proofing. That‚Äôs where Microsoft Graph comes in. In this post, I‚Äôll walk you through how to create Microsoft Entra ID users using PowerShell and Microsoft Graph‚Äîwith clean, scalable scripting.\nüï∞Ô∏è A (Very) Brief History of Microsoft Graph #\rIntroduced in 2015, Microsoft Graph unified dozens of fragmented Microsoft APIs‚ÄîAzure AD, Exchange, SharePoint, Teams‚Äîinto a single, modern endpoint. It\u0026rsquo;s now the backbone of identity and data access across Microsoft 365 and Azure services. Microsoft is phasing out older modules like AzureAD and MSOnline in favor of Graph, making it the go-to tool for cloud-native management and automation.\nüí° Smarter Entra ID User Creation with PowerShell + Graph #\rHere‚Äôs how to automate Entra ID user creation using PowerShell and Microsoft Graph‚Äîwith smart defaults, error handling, and dynamic group assignment. Creating users through the Azure Portal works\u0026hellip; until it doesn‚Äôt. Once you‚Äôre dealing with onboarding, consistency, or dynamic environments, it‚Äôs time to automate.\n‚öôÔ∏è Prerequisites #\rBefore we start scripting, make sure you have:\nPowerShell 7+ Microsoft Graph PowerShell SDK Admin permissions to Microsoft Entra ID Install-Module Microsoft.Graph -Scope CurrentUser Authenticate:\nConnect-MgGraph -Scopes \u0026#34;User.ReadWrite.All\u0026#34;, \u0026#34;Group.ReadWrite.All\u0026#34;, \u0026#34;Directory.Read.All\u0026#34; You\u0026rsquo;ll get a consent prompt to grant permission the first time.\rüõ†Ô∏è Define the User Creation Function #\rHere‚Äôs a reusable PowerShell function that creates a user and adds them to a security group.\nfunction New-SmartUser { param( [Parameter(Mandatory)] [string]$DisplayName, [Parameter(Mandatory)] [string]$UserPrincipalName, [Parameter(Mandatory)] [string]$Password, [Parameter(Mandatory)] [string]$Department, [Parameter()] [string]$GroupName = \u0026#34;Default Users\u0026#34; ) # Create the user $user = New-MgUser -AccountEnabled:$true ` -DisplayName $DisplayName ` -MailNickname ($UserPrincipalName.Split(\u0026#34;@\u0026#34;)[0]) ` -PasswordProfile @{ ForceChangePasswordNextSignIn = $true; Password = $Password } ` -UserPrincipalName $UserPrincipalName ` -Department $Department ` -UsageLocation \u0026#34;US\u0026#34; Write-Host \u0026#34;User \u0026#39;$($user.DisplayName)\u0026#39; created successfully.\u0026#34; # Find or create the group $group = Get-MgGroup -Filter \u0026#34;displayName eq \u0026#39;$GroupName\u0026#39;\u0026#34; -ErrorAction SilentlyContinue if (-not $group) { $group = New-MgGroup -DisplayName $GroupName ` -MailEnabled:$false -MailNickname:$GroupName.Replace(\u0026#34; \u0026#34;, \u0026#34;\u0026#34;) ` -SecurityEnabled:$true -GroupTypes @() Write-Host \u0026#34;Group \u0026#39;$GroupName\u0026#39; created.\u0026#34; } # Add user to group New-MgGroupMember -GroupId $group.Id -DirectoryObjectId $user.Id Write-Host \u0026#34;User added to group \u0026#39;$GroupName\u0026#39;.\u0026#34; } ‚úÖ Let‚Äôs Create a User #\rNew-SmartUser -DisplayName \u0026#34;Beast\u0026#34; ` -UserPrincipalName \u0026#34;hank.mccoy@logphile.com\u0026#34; ` -Password \u0026#34;l1n3arFus1on\u0026#34; ` -Department \u0026#34;R\u0026amp;D\u0026#34; ` -GroupName \u0026#34;Research \u0026amp; Development\u0026#34; \u0026#x1f4dc; The Results #\rC:\\Users\\beast\u0026gt; New-SmartUser -DisplayName \u0026#34;Beast\u0026#34; ` \u0026gt;\u0026gt; -UserPrincipalName \u0026#34;hank.mccoy@logphile.com\u0026#34; ` \u0026gt;\u0026gt; -Password \u0026#34;P@ssword123!\u0026#34; ` \u0026gt;\u0026gt; -Department \u0026#34;R\u0026amp;D\u0026#34; ` \u0026gt;\u0026gt; -GroupName \u0026#34;Research \u0026amp; Development\u0026#34; User \u0026#39;Beast\u0026#39; created successfully. Group \u0026#39;Research \u0026amp; Development\u0026#39; created. User added to group \u0026#39;Research \u0026amp; Development\u0026#39;. üîç Verify in the Portal #\rLog into Entra ID \u0026gt; Users and confirm the user shows up with correct info.\nThen check Groups to confirm group creation and membership.\nüß† Why This Matters #\rManual user creation introduces:\nTypos in emails or departments\nMissed group assignments\nNo audit trail\nAutomated creation ensures:\nConsistency\nScalability\nAuditability\nPlus, you‚Äôre scripting against Microsoft Graph‚Äîthe modern way to manage Microsoft 365.\nüöÄ What‚Äôs Next? #\rMake password generation secure (use New-Guid, or integrate with a vault)\nAdd license assignment via New-MgUserLicense\nExport logs or send Teams alerts on creation\nBundle into a CI pipeline using GitHub Actions or Azure DevOps\n‚öñÔ∏è Why Use PowerShell + Graph Over the Portal? #\rStill using the Azure Portal or legacy PowerShell modules like AzureAD or MSOnline? Reasons to change:\n‚úÖ Modern + Supported: Microsoft Graph is the future; older modules are deprecated. ‚úÖ Scriptable + Auditable: Build repeatable workflows and keep them in source control. ‚úÖ Richer Control: Set attributes, assign groups, and handle edge cases the portal hides. ‚úÖ Cross-Tenant Ready: Run the same script across multiple environments without clicking around. ‚úÖ Least Privilege: Use fine-grained Graph scopes instead of over-privileged admin accounts. ‚úÖ Error Handling: Catch issues like duplicate UPNs or missing license capacity in real-time. üìä Comparison: Portal vs Legacy PowerShell vs Graph + PowerShell #\rFeature Portal Old PowerShell (AzureAD) Graph + PowerShell Automation-ready ‚ùå ‚úÖ ‚úÖ‚úÖ Modern, supported ‚ùå ‚ö†Ô∏è Deprecated ‚úÖ‚úÖ Full attribute support ‚ùå ‚ùå ‚úÖ‚úÖ API-level consistency ‚ùå ‚ùå ‚úÖ‚úÖ Fine-grained permissions ‚ùå ‚ùå ‚úÖ‚úÖ Auditable/source-controllable ‚ùå ‚úÖ ‚úÖ‚úÖ Scalable across tenants ‚ùå ‚úÖ ‚úÖ‚úÖ üìé Resources #\rMicrosoft Graph PowerShell SDK Docs\nUser Object Docs\nGraph Permissions Guide\nAfter several years as a stay-at-home dad, I\u0026rsquo;m working my way back into the tech field‚Äîbrushing up on tools, learning what‚Äôs changed, and sharing the journey along the way. This blog is part learning tool, part signal to employers, and part proof of work. Thanks for reading!\r","date":"March 18, 2025","externalUrl":null,"permalink":"/blog/ditch-the-portal-create-entra-users-with-powershell-plus-graph/","section":"","summary":"Ditch the portal and script like a pro‚Äîthis post shows you how to create Entra ID users with PowerShell and Microsoft Graph for smarter, faster, mistake-free identity management.","title":"Ditch the Portal: Create Entra Users with PowerShell + Graph","type":"blog"},{"content":"","date":"March 18, 2025","externalUrl":null,"permalink":"/tags/entra/","section":"Tags","summary":"","title":"Entra","type":"tags"},{"content":" I got into computers the old-school way‚Äîthrough MUDs, BBSes, curiosity, and a dial-up connection. This became my one and only ask. While my friends were saving up for SNES cartridges, I was saving lawn-mowing money for a 28.8k modem. And I never really stopped.\nI‚Äôve spent two decades as a sysadmin‚Äîone of those ‚Äújack of all trades‚Äù types. I‚Äôve worked across stacks, made broken things work again, and kept things running quietly behind the scenes. Then I hit pause to focus on something even more important\u0026ndash;my daughter. That came with its own version of uptime monitoring, triage, and soft skills.\nNow that she‚Äôs older, I‚Äôm ready to step back into the field‚Äî-with fresh perspective, sharpened skills, and the same curiosity that got me into tech in the first place.\nlogPhile is where I document what I‚Äôm learning, building and exploring. Sometimes it‚Äôs cloud infrastructure. Sometimes it‚Äôs a weird little side project. Mostly it‚Äôs a way to stay honest, stay sharp, and keep moving forward.\nThanks for stopping by.\n","externalUrl":null,"permalink":"/about/","section":"","summary":"\u003c!-- raw HTML omitted --\u003e\n\u003c!-- raw HTML omitted --\u003e\n\u003cp\u003eI got into computers the old-school way‚Äîthrough \u003ca href=\"https://en.wikipedia.org/wiki/Multi-user_dungeon\" target=\"_blank\"\u003eMUDs\u003c/a\u003e, BBSes, curiosity, and a dial-up connection. This became my one and only ask. While my friends were saving up for SNES cartridges, I was saving lawn-mowing money for a 28.8k modem. And I never really stopped.\u003c/p\u003e","title":"","type":"about"},{"content":" 1. Introduction #\rWelcome to [logPhile] (\u0026ldquo;we,\u0026rdquo; \u0026ldquo;our,\u0026rdquo; or \u0026ldquo;us\u0026rdquo;). Your privacy is important to us. This Privacy Notice explains how we collect, use, disclose, and protect your personal information when you use our website, [logphile.com].\nBy continuing to use our site, you consent to the terms of this Privacy Notice.\n2. Information We Collect #\rWe collect different types of information to enhance your experience, including:\nPersonal Information (such as name, email address) when voluntarily provided by you. Usage Data (such as IP address, browser type, and pages visited) collected through cookies and analytics tools. Cookies and Tracking Technologies to improve site functionality and user experience. For more details on cookies, see Our Cookie Policy.\n3. How We Use Your Information #\rWe use the collected information for purposes including:\nProviding and improving our website. Enhancing user experience and personalization. Analyzing site traffic and engagement. Ensuring compliance with legal obligations. 4. How We Share Your Information #\rWe do not sell your personal data. However, we may share your data with:\nService Providers (e.g., hosting and analytics providers). Legal Authorities when required to comply with laws or protect rights. Third-Party Tools (e.g., Google Analytics) for website insights. 5. Your Rights \u0026amp; Choices #\rDepending on your location, you may have the right to:\nAccess, correct, or delete your data. Opt out of certain data processing. Request data portability. Withdraw consent for cookies or marketing communications. To make a request, please contact us.\n6. Data Retention \u0026amp; Security #\rWe retain your data only as long as necessary and implement safeguards to protect it from unauthorized access.\n7. Changes to This Notice #\rWe may update this Privacy Notice. Any changes will be posted with an updated ‚ÄúLast Updated‚Äù date.\n8. Contact Us #\rFor questions about this Privacy Notice, contact:\n","externalUrl":null,"permalink":"/privacy/","section":"logPhile","summary":"\u003c!-- raw HTML omitted --\u003e\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. Introduction \r\n    \u003cdiv id=\"1-introduction\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-introduction\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003eWelcome to \u003cstrong\u003e[logPhile]\u003c/strong\u003e (\u0026ldquo;we,\u0026rdquo; \u0026ldquo;our,\u0026rdquo; or \u0026ldquo;us\u0026rdquo;). Your privacy is important to us. This Privacy Notice explains how we collect, use, disclose, and protect your personal information when you use our website, [logphile.com].\u003c/p\u003e","title":"","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]